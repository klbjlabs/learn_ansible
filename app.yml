---

- name: ansible palybook
  hosts: all
  gather_facts: false
  remote_user: root
  # become: yes
  tasks:
    - name: test connect
      ping: 
    - name: ssh key auth
      authorized_key:
        user: root
        key: "{{ lookup('file', '~/.ssh/id_rsa.pub') }}"
        state: present
    - name: install tig package
      apt:
        name: tig
        state: latest       # install the latest version
        # state: removed    # remove the package
    - name: copy file to target hosts
      copy:
        src: ./files/hello.txt
        dest: /root/
    - name: install docker package
      apt:
        name: docker.io
        state: present
    - name: start docker service
      service:
        name: docker
        state: stopped    # [ started | stopped | restarted | reloaded ]
        enabled: true
